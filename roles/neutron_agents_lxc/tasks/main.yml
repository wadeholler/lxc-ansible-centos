---
- name: Create a neutrona1 centos container
  lxc_container:
    name: neutrona1
    template: centos.mod
    state: stopped
    container_command: |
      sed -i 's/dhcp/none/g' /etc/sysconfig/network-scripts/ifcfg-eth0
      ssh-keygen -N "" -f ~/.ssh/id_rsa
    container_config:
      - "lxc.network.link = br0"
      - "lxc.network.veth.pair = neutrona1_eth0"
      - "lxc.network.ipv4.gateway = 192.168.242.1"
      - "lxc.network.ipv4 = 192.168.242.216/24"
      - "lxc.pts = 1024"
      - "lxc.kmsg = 0"


- name: copy our authorized_key file into place
  copy: src=authorized_keys dest=/var/lib/lxc/neutrona1/rootfs/root/.ssh/authorized_keys mode=0600

- name: Start a container
  lxc_container:
    name: neutrona1
    state: started

- name: Create a neutrona2 centos container
  lxc_container:
    name: neutrona2
    template: centos.mod
    state: stopped
    container_command: |
      sed -i 's/dhcp/none/g' /etc/sysconfig/network-scripts/ifcfg-eth0
      ssh-keygen -N "" -f ~/.ssh/id_rsa
    container_config:
      - "lxc.network.link = br0"
      - "lxc.network.veth.pair = neutrona2_eth0"
      - "lxc.network.ipv4.gateway = 192.168.242.1"
      - "lxc.network.ipv4 = 192.168.242.217/24"
      - "lxc.pts = 1024"
      - "lxc.kmsg = 0"


- name: copy our authorized_key file into place
  copy: src=authorized_keys dest=/var/lib/lxc/neutrona2/rootfs/root/.ssh/authorized_keys mode=0600

- name: Start a container
  lxc_container:
    name: neutrona2
    state: started

